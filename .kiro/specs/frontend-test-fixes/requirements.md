# Requirements Document

## Introduction

This document specifies requirements for fixing frontend test failures caused by schema regeneration. The orb-schema-generator v0.13.5 changed model types (Date instead of string, PascalCase enum keys), requiring test data and assertions to be updated.

## Glossary

- **Test_Suite**: The Angular Karma test runner executing frontend unit tests
- **Model**: TypeScript interfaces and classes generated by orb-schema-generator
- **Test_Data_Factory**: Utility classes that create mock data for tests
- **Property_Test**: Tests using Node.js modules (fs, path) that cannot run in browser

## Requirements

### Requirement 1: Fix Date Type Mismatches

**User Story:** As a developer, I want all test mock data to use Date objects instead of ISO strings, so that tests compile and pass with the regenerated models.

#### Acceptance Criteria

1. WHEN a test creates mock user data, THE Test_Suite SHALL use `new Date()` instead of `new Date().toISOString()` for createdAt/updatedAt fields
2. WHEN a test creates mock organization data, THE Test_Suite SHALL use Date objects for all timestamp fields
3. WHEN a test creates mock application data, THE Test_Suite SHALL use Date objects for all timestamp fields

### Requirement 2: Fix Enum Key References

**User Story:** As a developer, I want all test code to use PascalCase enum keys, so that tests compile with the regenerated enums.

#### Acceptance Criteria

1. WHEN a test references OrganizationUserRole, THE Test_Suite SHALL use `Administrator` instead of `ADMINISTRATOR`
2. WHEN a test references OrganizationUserRole, THE Test_Suite SHALL use `Viewer` instead of `VIEWER`
3. WHEN a test references UserStatus, THE Test_Suite SHALL use `Active` instead of `ACTIVE`
4. WHEN a test references ApplicationStatus, THE Test_Suite SHALL use `Active` instead of `ACTIVE`

### Requirement 3: Fix Model Property Changes

**User Story:** As a developer, I want all test mock data to include required properties and exclude removed properties, so that tests compile with the regenerated models.

#### Acceptance Criteria

1. WHEN a test creates mock Applications data, THE Test_Suite SHALL include ownerId, apiKey, and environments fields
2. WHEN a test creates mock Applications data, THE Test_Suite SHALL NOT include description field
3. WHEN a test creates mock Users data, THE Test_Suite SHALL include all required fields per the IUsers interface

### Requirement 4: Fix Import Paths

**User Story:** As a developer, I want all test imports to reference the correct enum locations, so that tests compile.

#### Acceptance Criteria

1. WHEN a test imports UserStatus, THE Test_Suite SHALL import from `core/enums/UserStatusEnum`
2. WHEN a test imports UserGroup, THE Test_Suite SHALL import from `core/enums/UserGroupEnum`
3. WHEN a test imports OrganizationUserRole, THE Test_Suite SHALL import from `core/enums/OrganizationUserRoleEnum`
4. WHEN a test imports OrganizationUserStatus, THE Test_Suite SHALL import from `core/enums/OrganizationUserStatusEnum`

### Requirement 5: Migrate Property Tests to Node Environment

**User Story:** As a developer, I want property tests that use Node.js modules to run in a Node environment, so that they can execute successfully.

#### Acceptance Criteria

1. WHEN a property test uses fs/path/child_process modules, THE Test_Suite SHALL run it via Jest or a Node-based test runner
2. WHEN property tests are migrated, THE Test_Suite SHALL maintain the same test coverage and assertions

### Requirement 6: Fix Test Data Factories

**User Story:** As a developer, I want test data factories to generate valid mock data, so that all tests using factories pass.

#### Acceptance Criteria

1. WHEN OrganizationTestDataFactory creates test data, THE Factory SHALL use correct enum values and Date types
2. WHEN AuthTestDataFactory creates test data, THE Factory SHALL use correct enum values and Date types
3. WHEN test data factories use Record<string, T> types, THE Factory SHALL use bracket notation for property access

### Requirement 7: All Tests Pass

**User Story:** As a developer, I want all frontend tests to pass, so that CI/CD pipelines succeed.

#### Acceptance Criteria

1. WHEN `npm test` is executed, THE Test_Suite SHALL report 0 failures
2. WHEN `npm test` is executed, THE Test_Suite SHALL not disconnect or timeout
