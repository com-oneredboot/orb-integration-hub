<!-- Application Roles List Component Template -->
<!-- Displays roles for an application using DataGridComponent -->
<!-- @see .kiro/specs/application-roles-management/design.md -->
<!-- _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7_ -->

<div class="orb-card">
  <!-- Header -->
  <div class="orb-card__header">
    <h2 class="orb-card__title">
      <fa-icon icon="user-tag" class="orb-card__icon"></fa-icon>
      Roles
    </h2>
    <div class="orb-card__header-actions">
      <button class="orb-card-btn" (click)="onCreateRole()">
        <fa-icon icon="plus" class="orb-card-btn__icon"></fa-icon>
        Create Role
      </button>
    </div>
  </div>

  <!-- Data Grid -->
  <div class="orb-card__content">
    <app-data-grid
      [columns]="columns"
      [data]="(filteredRoleRows$ | async) || []"
      [pageState]="pageState"
      [sortState]="sortState"
      [filterState]="filterState"
      [loading]="(isLoading$ | async) || false"
      [showFilters]="true"
      [showPagination]="true"
      [showReset]="true"
      [selectable]="false"
      trackByField="role"
      emptyMessage="No roles defined"
      (pageChange)="onPageChange($event)"
      (sortChange)="onSortChange($event)"
      (filterChange)="onFilterChange($event)"
      (resetGrid)="onResetGrid()"
      (rowClick)="onRowClick($event)">
    </app-data-grid>
  </div>

  <!-- Error State -->
  <div class="orb-card__error" *ngIf="error$ | async as error">
    <fa-icon icon="exclamation-triangle" class="orb-card__error-icon"></fa-icon>
    <span>{{ error }}</span>
  </div>
</div>

<!-- Custom Cell Templates -->

<!-- Role Info Cell -->
<ng-template #roleInfoCell let-row>
  <div class="orb-info">
    <div class="orb-info__name">{{ row.role.roleName }}</div>
    <div class="orb-info__id">{{ row.role.applicationRoleId }}</div>
  </div>
</ng-template>

<!-- Role Type Cell -->
<ng-template #roleTypeCell let-row>
  <span 
    class="orb-role-type-badge orb-role-type-badge--{{ getRoleTypeClass(row.role.roleType) }}"
    [attr.aria-label]="'Role type: ' + row.roleTypeLabel">
    <fa-icon [icon]="getRoleTypeIcon(row.role.roleType)" class="orb-role-type-badge__icon"></fa-icon>
    {{ row.roleTypeLabel }}
  </span>
</ng-template>

<!-- Description Cell -->
<ng-template #descriptionCell let-row>
  <span class="orb-description" *ngIf="row.role.description">{{ row.role.description }}</span>
  <span class="orb-description orb-description--empty" *ngIf="!row.role.description">â€”</span>
</ng-template>

<!-- Status Cell -->
<ng-template #statusCell let-row>
  <span 
    class="orb-status-badge orb-status-badge--{{ getStatusBadgeType(row.role.status) }}"
    [attr.aria-label]="'Status: ' + row.statusLabel">
    {{ row.statusLabel }}
  </span>
</ng-template>

<!-- Last Activity Cell -->
<ng-template #lastActivityCell let-row>
  <span class="orb-info__id">{{ row.lastActivity }}</span>
</ng-template>

<!-- Dialogs -->
<app-create-role-dialog
  [applicationId]="applicationId || ''"
  [organizationId]="organizationId || ''"
  [isOpen]="(showCreateDialog$ | async) || false"
  (closed)="onCreateDialogClosed()">
</app-create-role-dialog>

<app-edit-role-dialog
  [role]="(selectedRole$ | async)"
  [isOpen]="(showEditDialog$ | async) || false"
  (closed)="onEditDialogClosed()">
</app-edit-role-dialog>
