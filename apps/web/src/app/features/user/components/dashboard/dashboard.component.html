<!-- 
file: frontend/src/app/features/user/components/dashboard/dashboard.component.html
author: Corey Dale Peters
date: 2025-03-07
description: Dashboard CTA Hub - Single column layout with role-based CTA cards
-->

<div class="dashboard-container">
  <!-- Global Loading Indicator -->
  <div *ngIf="isLoading$ | async" class="orb-loading-overlay">
    <!-- Loading Bar -->
    <div class="orb-loading-indicator">
      <div class="orb-loading-indicator__content">
        <fa-icon icon="clock" class="orb-loading-indicator__icon"></fa-icon>
        <span class="orb-loading-indicator__text">Processing...</span>
      </div>
    </div>
    
    <!-- Overlay Mask -->
    <div class="orb-loading-mask"></div>
  </div>

  <!-- Page Header -->
  <div class="orb-page-header">
    <div class="orb-page-header__content">
      <div class="orb-page-header__flex-container">
        <div class="orb-page-header__logo-section">
          <img src="assets/orb-logo.jpg" alt="Orb Integration Hub Logo" class="orb-page-header__logo">
        </div>
        <div class="orb-page-header__text-section" *ngIf="currentUser$ | async as user">
          <div class="orb-page-header__greeting">
            <div class="orb-page-header__icon-title">
              <img src="../../../../../assets/hardhat.jpg" alt="Engineering" class="orb-page-header__icon">
              <h1 class="orb-page-header__title">
                Integration Hub
              </h1>
            </div>
            <p class="orb-page-header__subtitle" *ngIf="user.status === 'ACTIVE'; else pendingDashboardMessage">
              Your integration hub is ready for action
            </p>
            <ng-template #pendingDashboardMessage>
              <p class="orb-page-header__subtitle orb-page-header__subtitle--warning">
                Complete your profile setup to activate your account
              </p>
            </ng-template>
            <p class="orb-page-header__hint">
              Complete the actions below to get started. Use the quick access menu on the left for common tasks.
            </p>
            <div class="orb-page-header__status">
              <span class="orb-header-badge" 
                    [ngClass]="'orb-header-badge--' + getStatusClass(user.status)">
                <fa-icon [icon]="getStatusIcon(user.status)" class="orb-header-badge__icon"></fa-icon>
                {{ getStatusLabel(user.status) }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Dashboard Content -->
  <div class="dashboard-content" *ngIf="currentUser$ | async as user; else loadingUser">
    
    <!-- CTA Hub Layout: Cards -->
    <div class="dashboard-cta-layout">
      
      <!-- Main CTA Column -->
      <main class="dashboard-cta-layout__main">
        
        <!-- CTA Cards -->
        <div class="dashboard-cta-cards">
          <app-cta-card
            *ngFor="let card of ctaCards$ | async; trackBy: trackByCardId"
            [card]="card"
            (actionTriggered)="onCtaCardAction($event)">
          </app-cta-card>
          
          <!-- Empty State when no cards -->
          <div class="dashboard-cta-cards__empty" 
               *ngIf="(ctaCards$ | async)?.length === 0">
            <fa-icon icon="check-circle" class="dashboard-cta-cards__empty-icon"></fa-icon>
            <h3 class="dashboard-cta-cards__empty-title">All caught up!</h3>
            <p class="dashboard-cta-cards__empty-text">
              You've completed all setup tasks. Use the navigation menu to explore your workspace.
            </p>
          </div>
        </div>
        
      </main>
      
    </div>

  </div>
  
  <!-- Loading template when no user data is available -->
  <ng-template #loadingUser>
    <div class="dashboard-content" style="text-align: center; padding: 40px;">
      <div class="loading-state">
        <h2>Loading your dashboard...</h2>
        <p>Please wait while we fetch your user information.</p>
      </div>
    </div>
  </ng-template>
  
  <!-- Debug Panel using shared component -->
  <app-debug-panel
    [visible]="(debugMode$ | async) || false"
    [title]="'Dashboard Debug'"
    [logs$]="debugLogs$"
    [context]="debugContext">
  </app-debug-panel>
</div>
