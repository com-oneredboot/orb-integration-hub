# file: schemas/tables/OrganizationUsers.yml
# author: orb-integration-hub
# date: 2026-01-09
# description: OrganizationUsers table schema for managing user membership in organizations

type: dynamodb
pitr_enabled: false
version: '1.0'
name: OrganizationUsers
targets:
  - python-main
  - ts-main
  - graphql-main
model:
  authConfig:
    cognitoAuthentication:
      groups:
        OWNER:
          - '*'
        EMPLOYEE:
          - '*'
        CUSTOMER:
          - '*'
  keys:
    primary:
      partition: userId
      sort: organizationId
      description: Composite key for user-organization membership
    secondary:
      - name: OrganizationMembersIndex
        type: GSI
        partition: organizationId
        sort: role
        projection_type: ALL
        description: Index for querying members of an organization by role
      - name: UserOrganizationsIndex
        type: GSI
        partition: userId
        sort: role
        projection_type: ALL
        description: Index for querying organizations a user belongs to by role
  attributes:
    userId:
      type: string
      required: true
      description: ID of the user (foreign key to Users table)
    organizationId:
      type: string
      required: true
      description: ID of the organization (foreign key to Organizations table)
    role:
      type: string
      required: true
      enum_type: OrganizationUserRole
      description: Role of the user within the organization
    status:
      type: string
      required: true
      enum_type: OrganizationUserStatus
      description: Status of the user's membership
    invitedBy:
      type: string
      required: false
      description: ID of the user who invited this member
    invitedAt:
      type: timestamp
      required: false
      description: When the invitation was sent
    joinedAt:
      type: timestamp
      required: false
      description: When the user accepted and joined
    createdAt:
      type: timestamp
      required: true
      description: When the membership record was created
    updatedAt:
      type: timestamp
      required: true
      description: When the membership record was last updated
