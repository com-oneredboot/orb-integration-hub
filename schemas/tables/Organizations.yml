# file: schemas/tables/Organizations.yml
# author: orb-integration-hub
# date: 2026-01-09
# description: Organizations table schema for multi-tenant organization management

type: dynamodb
pitr_enabled: false
version: '1.0'
name: Organizations
targets:
  - python-main
  - ts-main
  - graphql-main
model:
  authConfig:
    cognitoAuthentication:
      groups:
        OWNER:
          - '*'
        EMPLOYEE:
          - '*'
        CUSTOMER:
          - '*'
  keys:
    primary:
      partition: organizationId
      description: Primary key for organizations (unique for each organization)
    secondary:
      - name: OwnerIndex
        type: GSI
        partition: ownerId
        sort: createdAt
        projection_type: ALL
        description: Index for querying organizations by owner with creation time ordering
      - name: StatusCreatedIndex
        type: GSI
        partition: status
        sort: createdAt
        projection_type: ALL
        description: Index for querying organizations by status with creation time ordering
  attributes:
    organizationId:
      type: string
      required: true
      description: Unique identifier for the organization (primary key)
    name:
      type: string
      required: true
      description: Name of the organization
    description:
      type: string
      required: false
      description: Optional description of the organization
    ownerId:
      type: string
      required: true
      description: ID of the CUSTOMER user who owns the organization (foreign key to Users)
    status:
      type: string
      required: true
      enum_type: OrganizationStatus
      description: Current status of the organization
    createdAt:
      type: timestamp
      required: true
      description: When the organization was created
    updatedAt:
      type: timestamp
      required: true
      description: When the organization was last updated
    kmsKeyId:
      type: string
      required: false
      description: Organization-specific KMS key ID for encryption
    kmsKeyArn:
      type: string
      required: false
      description: Organization-specific KMS key ARN
    kmsAlias:
      type: string
      required: false
      description: Organization-specific KMS key alias name
    applicationCount:
      type: integer
      required: false
      default: 0
      description: Denormalized count of applications belonging to this organization
