"""
Base GraphQL schema.
Generated at {{ timestamp }}.
"""

# Enums
enum Status {
  ACTIVE
  INACTIVE
  DELETED
}

enum UserGroups {
  ADMIN
  USER
}

enum ApplicationEnvironments {
  DEV
  STAGING
  PROD
}

# Base types
type Query {
  ping: String
}

type Mutation {
  ping: String
}

# Model types
{% for table_name, schema in schemas.items() %}
type {{ table_name | to_pascal_case }} {
  {% for attr in schema.attributes %}
  {{ attr.name | to_camel_case }}: {% if attr.type == 'N' %}Int{% else %}String{% endif %}!
  {% endfor %}
}

input {{ table_name | to_pascal_case }}CreateInput {
  {% for attr in schema.attributes %}
  {{ attr.name | to_camel_case }}: {% if attr.type == 'N' %}Int{% else %}String{% endif %}!
  {% endfor %}
}

input {{ table_name | to_pascal_case }}UpdateInput {
  {% for attr in schema.attributes %}
  {{ attr.name | to_camel_case }}: {% if attr.type == 'N' %}Int{% else %}String{% endif %}
  {% endfor %}
}

input {{ table_name | to_pascal_case }}QueryInput {
  {{ schema.partition_key | to_camel_case }}: String!
  {% if schema.sort_key %}
  {{ schema.sort_key | to_camel_case }}: String
  {% endif %}
}

type {{ table_name | to_pascal_case }}Response {
  statusCode: Int!
  message: String!
  data: {{ table_name | to_pascal_case }}
}

type {{ table_name | to_pascal_case }}ListResponse {
  statusCode: Int!
  message: String!
  data: [{{ table_name | to_pascal_case }}]
}

{% endfor %}

# Query operations
extend type Query {
  {% for table_name, schema in schemas.items() %}
  {{ table_name | to_camel_case }}QueryById(id: ID!): {{ table_name | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  
  {{ table_name | to_camel_case }}Query(input: {{ table_name | to_pascal_case }}QueryInput): {{ table_name | to_pascal_case }}ListResponse
    @aws_auth(cognito_groups: ["admin"])
  {% endfor %}
}

# Mutation operations
extend type Mutation {
  {% for table_name, schema in schemas.items() %}
  {{ table_name | to_camel_case }}Create(input: {{ table_name | to_pascal_case }}CreateInput!): {{ table_name | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  
  {{ table_name | to_camel_case }}Update(id: ID!, input: {{ table_name | to_pascal_case }}UpdateInput!): {{ table_name | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  
  {{ table_name | to_camel_case }}Delete(id: ID!): {{ table_name | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  {% endfor %}
}