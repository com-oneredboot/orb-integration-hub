"""
Base GraphQL schema.
Generated at {{ timestamp }}.

This schema follows these conventions:
- Type names: PascalCase (e.g., ApplicationRole)
- Field names: camelCase (e.g., applicationId)
- Input types: PascalCase with Input suffix (e.g., ApplicationRoleInput)
- Response types: PascalCase with Response suffix (e.g., ApplicationRoleResponse)
- List response types: PascalCase with ListResponse suffix (e.g., ApplicationRoleListResponse)
- Query operations: PascalCase with Query suffix (e.g., ApplicationRoleQuery)
- Mutation operations: PascalCase with action suffix (e.g., ApplicationRoleCreate)
- Response fields: PascalCase (e.g., StatusCode, Message, Data)

All operations are secured with AWS Cognito user pool authentication for the admin group.
"""

# Enums
{% for table_name, schema in schemas.items() %}
{% for attr in schema.attributes %}
{% if attr.enum_type %}
enum {{ attr.enum_type }} {
    {% for value in attr.enum_values %}
    {{ value }}
    {% endfor %}
}
{% endif %}
{% endfor %}
{% endfor %}

# Base types
type Query {
  Ping: String
  {% for table_name, schema in schemas.items() %}
  {{ schema.table | to_pascal_case }}QueryBy{{ schema.partition_key | to_pascal_case }}(input: {{ schema.table | to_pascal_case }}QueryBy{{ schema.partition_key | to_pascal_case }}Input!): {{ schema.table | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  {% if schema.sort_key and schema.sort_key != 'None' %}
  {{ schema.table | to_pascal_case }}QueryBy{{ schema.sort_key | to_pascal_case }}(input: {{ schema.table | to_pascal_case }}QueryBy{{ schema.sort_key | to_pascal_case }}Input!): {{ schema.table | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  {{ schema.table | to_pascal_case }}QueryByBoth(input: {{ schema.table | to_pascal_case }}QueryByBothInput!): {{ schema.table | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  {% endif %}
  {% for index in schema.secondary_indexes %}
  {{ schema.table | to_pascal_case }}QueryBy{{ index.partition | to_pascal_case }}(input: {{ schema.table | to_pascal_case }}QueryBy{{ index.partition | to_pascal_case }}Input!): {{ schema.table | to_pascal_case }}ListResponse
    @aws_auth(cognito_groups: ["admin"])
  {% endfor %}
  {% endfor %}
}

type Mutation {
  Ping: String
  {% for table_name, schema in schemas.items() %}
  {{ schema.table | to_pascal_case }}Create(input: {{ schema.table | to_pascal_case }}CreateInput!): {{ schema.table | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  {{ schema.table | to_pascal_case }}Update(input: {{ schema.table | to_pascal_case }}UpdateInput!): {{ schema.table | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  {{ schema.table | to_pascal_case }}Delete(id: ID!): {{ schema.table | to_pascal_case }}Response
    @aws_auth(cognito_groups: ["admin"])
  {% endfor %}
}

# Model types
{% for table_name, schema in schemas.items() %}
type {{ schema.table | to_pascal_case }} {
  {% for attr in schema.attributes %}
  {{ attr.name | to_camel_case }}: {% if attr.enum_type %}{{ attr.enum_type }}{% else %}{% if attr.type == 'timestamp' %}AWSDateTime{% elif attr.type == 'boolean' %}Boolean{% elif attr.type == 'array' %}[String]{% else %}String{% endif %}{% endif %}!
  {% endfor %}
}

input {{ schema.table | to_pascal_case }}CreateInput {
  {% for attr in schema.attributes %}
  {{ attr.name | to_camel_case }}: {% if attr.enum_type %}{{ attr.enum_type }}{% else %}{% if attr.type == 'timestamp' %}AWSDateTime{% elif attr.type == 'boolean' %}Boolean{% elif attr.type == 'array' %}[String]{% else %}String{% endif %}{% endif %}!
  {% endfor %}
}

input {{ schema.table | to_pascal_case }}UpdateInput {
  {% for attr in schema.attributes %}
  {{ attr.name | to_camel_case }}: {% if attr.enum_type %}{{ attr.enum_type }}{% else %}{% if attr.type == 'timestamp' %}AWSDateTime{% elif attr.type == 'boolean' %}Boolean{% elif attr.type == 'array' %}[String]{% else %}String{% endif %}{% endif %}
  {% endfor %}
}

input {{ schema.table | to_pascal_case }}QueryBy{{ schema.partition_key | to_pascal_case }}Input {
  {{ schema.partition_key | to_camel_case }}: String!
}

{% if schema.sort_key and schema.sort_key != 'None' %}
input {{ schema.table | to_pascal_case }}QueryBy{{ schema.sort_key | to_pascal_case }}Input {
  {{ schema.sort_key | to_camel_case }}: String!
}

input {{ schema.table | to_pascal_case }}QueryByBothInput {
  {{ schema.partition_key | to_camel_case }}: String!
  {{ schema.sort_key | to_camel_case }}: String!
}
{% endif %}
{% for index in schema.secondary_indexes %}
input {{ schema.table | to_pascal_case }}QueryBy{{ index.partition | to_pascal_case }}Input {
  {{ index.partition | to_camel_case }}: String!{% if index.sort and index.sort != 'None' %}
  {{ index.sort | to_camel_case }}: String!{% endif %}
}
{% endfor %}

type {{ schema.table | to_pascal_case }}Response {
  StatusCode: Int!
  Message: String!
  Data: {{ schema.table | to_pascal_case }}
}

type {{ schema.table | to_pascal_case }}ListResponse {
  StatusCode: Int!
  Message: String!
  Data: [{{ schema.table | to_pascal_case }}]
}

{% endfor %}